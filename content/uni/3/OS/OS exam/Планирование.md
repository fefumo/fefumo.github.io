#uni 
#prog
# Планировние
Виды:
- Краткосрочное планирование (ready, running, blocked)
- Среднесровное планирование (ready,suspend/blocked, suspend)
- Долгосрочное планирование (new, exit)

Критерии:
- Пользовательские, связанные с производительностью
	- Turnaround time — время оборота 
	- Response time — время отклика 
	- Deadline — предельное время 
- Пользовательские, иные
	- Predictability — предсказуемость
- Системные, связанные с производительнстью
	- Throughput — пропускная способность
	- Processor Utilization — загруженность процессора 
- Системные, иные
	- Fairness — справедливость 
	- Enforcing priorities — принудительная приоритезация 
	- Balancing resources — сбалансированная нагрузка

Используется система приоритетов (цифровой приоритет). По умолчанию выбирается процесс с наивысшим приоритетом.
Если приоритеты процессов совпадают, то используется дополнительная стратегия.

Стратегии: 
- FCFS `max(w)`
- Round robin `const TQ`
- SPN `min(s)`
- SRE `min(s-e)`
- feedback `w up –> prio up, e up → prio down`
w — время ожидания, e — время выполнения, s — общее для обслуживания процесса, включая “e”.

В feedback стратегии (в т.ч. для Solaris SVR4):
- глобальный приоритет
- quantum выделяемый квант времени (мс)
- tqexp приоритет, если квант полностью выбран CPU
- slpret приоритет, если ожидаем ресурса
- lwait приоритет в случае длинного ожидания ресурса

Классы планирования:
- 0-59 — пользовательские процессы
- 60-99 — процессы ядра 
- 100-159 — процессы real time 
- 160-169 — процессы прерываний

##### Справедливое планирование SVR4
При справедливом планировании каждой группе процессов выделяются кванты администрирования (shares). Доля ресурсов группы вычисляется как отношение ее shares к их сумме.
Пример со слайда: три группы - 60-20-40, сумма - 120, доля ресурсов - 60/120 = 50%, 20/120 = 16,6%. 40/120 = 33,3%.
- Выделяет время процессора на основании заданных user shares
- Используется как замена TS/IA классов 
- Учитывает все процессоры в системе

## Многопроцессорное планирование 
Типы многопроцессорных систем 
- Слабосвязанные
	- Набор систем со своей основной памятью и подсистемой ввода-вывода
	- Распределение заданий между системами
	- Распределение общих данных и результатов
- Функционально-специализированные
	- Ведущий процессор выполняет координацию
	- Ведомые процессоры выполняют вычисления
- Сильносвязаные процессоры
	- Управляются одной ОС
	- Имеют общую память и систему кэшей

Гранулярность синхронизации — частота синхронизации между процессами в системе
Тонкая — параллельные вычисления на уровне отдельных машинных команд (<20 команд). Пример: видеоигры.
Средняя — на уровне одного приложения (20-200 команд). Обычные приложения. 
Грубая — на уровне взаимодействующих процессов  (200-2000 команд).
Независимая — нет синхронизации, независимые процессы

Вопросы проектирования планировщика в случае многопроцессорных систем:
- Назначение процессов процессорам 
	- Статическое — выделяем процессор для процесса
	- Динамическое — общая очередь для всех процессов 
	- Динамическая балансировка нагрузки
- Использование многозадачности на отдельных процессорах
- Диспетчеризация процесса
	- Так ли плох будет FCFS?  влияние выбора алгоритма диспетчеризации снижается.

Подходы к планированию потоков: 
- Load Sharing — глобальная очередь потоков
- Gang scheduling — связанные потоки распределяются на связанные процессы по одному на процессор 
- Dedicated processor assignment — назначается пул процессоров равный количеству потоков
- Динамическое планирование
